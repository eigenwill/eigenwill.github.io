<!doctype html><html lang=zh-cn dir=ltr><head><meta charset=utf-8><meta name=viewport content='width=device-width,initial-scale=1'><meta name=description content="# Prologue: an atomistic view of electrical resistance # Energy level diagram 每一层能级电子的占据数量由 Fermi function 决定 $f_0(E-\\mu)=\\frac1{1+\\exp[(E-\\mu)/k_\\text{B}T]}$ 电流是由化学势 $E = \\mu$ 附近的可获取的能级的数量决定的 正的$V_G$ 将能级拉低 所以阈"><title>半导体中的量子输运(1)</title>
<link rel=canonical href=https://eigenwill.github.io/p/%E5%8D%8A%E5%AF%BC%E4%BD%93%E4%B8%AD%E7%9A%84%E9%87%8F%E5%AD%90%E8%BE%93%E8%BF%901/><link rel=stylesheet href=/scss/style.min.8e60baf4cd3fc55968717a6e39762f4d28ed7ef6007566b6c7970ad0fe907198.css><meta property='og:title' content="半导体中的量子输运(1)"><meta property='og:description' content="# Prologue: an atomistic view of electrical resistance # Energy level diagram 每一层能级电子的占据数量由 Fermi function 决定 $f_0(E-\\mu)=\\frac1{1+\\exp[(E-\\mu)/k_\\text{B}T]}$ 电流是由化学势 $E = \\mu$ 附近的可获取的能级的数量决定的 正的$V_G$ 将能级拉低 所以阈"><meta property='og:url' content='https://eigenwill.github.io/p/%E5%8D%8A%E5%AF%BC%E4%BD%93%E4%B8%AD%E7%9A%84%E9%87%8F%E5%AD%90%E8%BE%93%E8%BF%901/'><meta property='og:site_name' content="Will's blog"><meta property='og:type' content='article'><meta property='article:section' content='Post'><meta property='article:published_time' content='2024-04-23T14:11:57+08:00'><meta property='article:modified_time' content='2024-04-23T14:11:57+08:00'><meta name=twitter:title content="半导体中的量子输运(1)"><meta name=twitter:description content="# Prologue: an atomistic view of electrical resistance # Energy level diagram 每一层能级电子的占据数量由 Fermi function 决定 $f_0(E-\\mu)=\\frac1{1+\\exp[(E-\\mu)/k_\\text{B}T]}$ 电流是由化学势 $E = \\mu$ 附近的可获取的能级的数量决定的 正的$V_G$ 将能级拉低 所以阈"><link rel="shortcut icon" href=/favicon.png></head><body class=article-page><script>(function(){const e="StackColorScheme";localStorage.getItem(e)||localStorage.setItem(e,"auto")})()</script><script>(function(){const t="StackColorScheme",e=localStorage.getItem(t),n=window.matchMedia("(prefers-color-scheme: dark)").matches===!0;e=="dark"||e==="auto"&&n?document.documentElement.dataset.scheme="dark":document.documentElement.dataset.scheme="light"})()</script><div class="container main-container flex on-phone--column extended"><aside class="sidebar left-sidebar sticky"><button class="hamburger hamburger--spin" type=button id=toggle-menu aria-label=切换菜单>
<span class=hamburger-box><span class=hamburger-inner></span></span></button><header><figure class=site-avatar><a href=/><img src=/img/avatar_hu5a50d6e5e41305f5b0a16fd0801986ac_136907_300x0_resize_box_3.png width=300 height=300 class=site-logo loading=lazy alt=Avatar>
</a><span class=emoji>😓</span></figure><div class=site-meta><h1 class=site-name><a href=/>Will's blog</a></h1><h2 class=site-description>一个不知道课题做啥的微电子PhD在读</h2></div></header><ol class=menu-social><li><a href=https://github.com/eigenwill target=_blank title=GitHub rel=me><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-brand-github" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M9 19c-4.3 1.4-4.3-2.5-6-3m12 5v-3.5c0-1 .1-1.4-.5-2 2.8-.3 5.5-1.4 5.5-6a4.6 4.6.0 00-1.3-3.2 4.2 4.2.0 00-.1-3.2s-1.1-.3-3.5 1.3a12.3 12.3.0 00-6.2.0C6.5 2.8 5.4 3.1 5.4 3.1a4.2 4.2.0 00-.1 3.2A4.6 4.6.0 004 9.5c0 4.6 2.7 5.7 5.5 6-.6.6-.6 1.2-.5 2V21"/></svg></a></li></ol><ol class=menu id=main-menu><li><a href=/><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-home" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><polyline points="5 12 3 12 12 3 21 12 19 12"/><path d="M5 12v7a2 2 0 002 2h10a2 2 0 002-2v-7"/><path d="M9 21v-6a2 2 0 012-2h2a2 2 0 012 2v6"/></svg>
<span>Home</span></a></li><li><a href=/archives/><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-archive" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><rect x="3" y="4" width="18" height="4" rx="2"/><path d="M5 8v10a2 2 0 002 2h10a2 2 0 002-2V8"/><line x1="10" y1="12" x2="14" y2="12"/></svg>
<span>Archives</span></a></li><li><a href=/search/><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-search" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="10" cy="10" r="7"/><line x1="21" y1="21" x2="15" y2="15"/></svg>
<span>Search</span></a></li><li><a href=/links/><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-link" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><path d="M10 14a3.5 3.5.0 005 0l4-4a3.5 3.5.0 00-5-5l-.5.5"/><path d="M14 10a3.5 3.5.0 00-5 0l-4 4a3.5 3.5.0 005 5l.5-.5"/></svg>
<span>Links</span></a></li><li><a href=/ target=_blank><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-home" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><polyline points="5 12 3 12 12 3 21 12 19 12"/><path d="M5 12v7a2 2 0 002 2h10a2 2 0 002-2v-7"/><path d="M9 21v-6a2 2 0 012-2h2a2 2 0 012 2v6"/></svg>
<span>Home</span></a></li><li class=menu-bottom-section><ol class=menu><li id=dark-mode-toggle><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-toggle-left" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="8" cy="12" r="2"/><rect x="2" y="6" width="20" height="12" rx="6"/></svg>
<svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-toggle-right" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="16" cy="12" r="2"/><rect x="2" y="6" width="20" height="12" rx="6"/></svg>
<span>暗色模式</span></li></ol></li></ol></aside><aside class="sidebar right-sidebar sticky"><section class="widget archives"><div class=widget-icon><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-hash" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><line x1="5" y1="9" x2="19" y2="9"/><line x1="5" y1="15" x2="19" y2="15"/><line x1="11" y1="4" x2="7" y2="20"/><line x1="17" y1="4" x2="13" y2="20"/></svg></div><h2 class="widget-title section-title">目录</h2><div class=widget--toc><nav id=TableOfContents><ol><li><a href=#energy-level-diagram>Energy level diagram</a></li><li><a href=#what-makes-electrons-flow>What makes electrons flow?</a><ol><li><a href=#one-level-model>one level model</a></li><li><a href=#pauli-blocking>Pauli blocking</a></li></ol></li><li><a href=#the-quantum-of-conductance>The quantum of conductance</a></li><li><a href=#potential-profile>Potential profile</a><ol><li><a href=#iterative-procedure-for-self-consistent-solution>Iterative procedure for self-consistent solution</a></li></ol></li></ol></nav></div></section></aside><main class="main full-width"><article class=main-article><header class=article-header><div class=article-details><div class=article-title-wrapper><h2 class=article-title><a href=/p/%E5%8D%8A%E5%AF%BC%E4%BD%93%E4%B8%AD%E7%9A%84%E9%87%8F%E5%AD%90%E8%BE%93%E8%BF%901/>半导体中的量子输运(1)</a></h2></div><footer class=article-time><div><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-calendar-time" width="56" height="56" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><path d="M11.795 21H5a2 2 0 01-2-2V7a2 2 0 012-2h12a2 2 0 012 2v4"/><circle cx="18" cy="18" r="4"/><path d="M15 3v4"/><path d="M7 3v4"/><path d="M3 11h16"/><path d="M18 16.496V18l1 1"/></svg>
<time class=article-time--published>Apr 23, 2024</time></div><div><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-clock" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="12" cy="12" r="9"/><polyline points="12 7 12 12 15 15"/></svg>
<time class=article-time--reading>阅读时长: 4 分钟</time></div></footer></div></header><section class=article-content><h1 id=prologue-an-atomistic-view-of-electrical-resistance><a href=#prologue-an-atomistic-view-of-electrical-resistance>#</a>
Prologue: an atomistic view of electrical resistance</h1><h2 id=energy-level-diagram><a href=#energy-level-diagram>#</a>
Energy level diagram</h2><p>每一层能级电子的占据数量由 Fermi function 决定</p><p>$f_0(E-\mu)=\frac1{1+\exp[(E-\mu)/k_\text{B}T]}$</p><p>电流是由化学势 $E = \mu$ 附近的<strong>可获取的</strong>能级的数量决定的</p><p>正的$V_G$ 将能级拉低</p><p>所以阈值电压$V_T$ 是化学势$\mu$ 和<strong>最低可获取的空状态</strong>也就是导带底的静电势之差</p><h2 id=what-makes-electrons-flow><a href=#what-makes-electrons-flow>#</a>
What makes electrons flow?</h2><p>这一节是来解释为什么：</p><blockquote><p>电流是由化学势 $E = \mu$ 附近的<strong>可获取的</strong>能级的数量决定的，而与能级是否被占据无关</p></blockquote><p>在源漏两端加上电压：</p><p>$\mu_1 - \mu_2 = q V_D$</p><p>$f_1(E)\equiv\frac1{1+\exp[(E-\mu_1)/k_\text{B}T]}=f_0(E-\mu_1)$</p><p>$f_2(E)\equiv\frac1{1+\exp[(E-\mu_2)/k_\text{B}T]}=f_0(E-\mu_2)$</p><h3 id=one-level-model><a href=#one-level-model>#</a>
one level model</h3><p>假设沟道中只有一个能级$\varepsilon$在两侧接触的化学势的中间，那么两个接触分别希望看到沟道中有$f_1(\varepsilon)$ 和$f_2(\varepsilon)$ 个电子，所以平均电子数量$N$ 在$f_1(\varepsilon)$和$f_2(\varepsilon)$ 之间，数量不均匀会导致电流流过：</p><p>$I_1=\frac{q\mathrm{~}\gamma_1}\hbar(f_1-N)$</p><p>$I_2=\frac{q\gamma_2}\hbar(f_2-N)$</p><p>其中$\gamma / \hbar$ 可以被解释为电子处于能级$\varepsilon$ 可以流向源或者漏的概率。</p><p>在平衡状态下：</p><p>$I=I_1=-I_2=\frac q\hbar\frac{\gamma_1\gamma_2}{\gamma_1+\gamma_2}\left[f_1(\varepsilon)-f_2(\varepsilon)\right]$</p><p>所以只有能级在两个化学式$\mu$ 中间的能级才能对电流有贡献，而与能级是否被占据无关，只是电子先被注入还是先被抽走的区别罢了。</p><h3 id=pauli-blocking><a href=#pauli-blocking>#</a>
Pauli blocking</h3><p>因为泡利不相容，所以influx不止单独跟contact相关，而是跟channel里电子的数量相关，对outflux也一样，所以电流应该是$\gamma_1f_1(1-N)$ 和$\gamma_1N(1-f_1)$ ，但是最终两者之和是一样的，结果不变的。</p><p>但是contact和channel耦合带来的level broadening是会带来影响的，好像还跟$\gamma$ 的物理含义有关，但是书中没有明讲，要看第9章和第10章还有附录。</p><h2 id=the-quantum-of-conductance><a href=#the-quantum-of-conductance>#</a>
The quantum of conductance</h2><p>假设有一个但能级系统且温度很低：</p><p>$I=\frac q\hbar\frac{\gamma_1\gamma_2}{\gamma_1+\gamma_2}=\frac{q\gamma_1}{2\hbar}\quad\mathrm{~if~}\quad\gamma_2=\gamma_1$</p><p>增加 $\gamma$ 应该会让电流无限增长，但是电导有个上限：</p><p>$G_0\equiv q^2/h=38.7\mathrm{~\mu S}=(25.8\mathrm{~k}\Omega)^{-1}$</p><p>[image]<br>(<a class=link href=zotero://select/library/items/6W5WRBAX>Datta, 2005, p. 11</a>)</p><p>[image]</p><p>缺少考虑的部分就是<strong>level broadening</strong> 能级展宽。沟道中的能级会在金属接触位置发生展宽。由于一部分能级将超出两边化学势的范围，电流将会减少 $(\mu_1-\mu_2)/C\gamma_1$ ，$C\gamma_1$ 是能级的宽度,</p><p>$I=\frac{q\gamma_1}{2\hbar}\frac{qV_{\mathrm{D}}}{C\gamma_1}\to G=\frac I{V_{\mathrm{D}}}=\frac{q^2}{2C\hbar}$</p><p><em>为什么只考虑source附近的展宽？</em></p><p>DOS在channel和contact耦合之后会扩展，有一些state从channel进入contact,有一些从contact进入channel，因为获得的state来自许多能级，所以channel中的DOS会展宽，可以用洛伦兹分布建模：</p><p>$D_\varepsilon(E)=\frac{\gamma/2\pi}{\left(E-\varepsilon\right)^2+\left(\gamma/2\right)^2}$</p><p>$\gamma$ 的物理含义会在第8章解释，但是可以简单认为态的寿命 $\hbar / \gamma$ （它的倒数就是电子的逃逸概率，如前一节所述），和能级展宽 $\gamma$ 的乘积等于 $\hbar$ ——不确定性原理。</p><p>我们可以计算电流了（假设温度很低且电压很小）</p><p>$I=\frac q\hbar\int_{-\infty}^{+\infty}\mathrm{d}ED_\varepsilon(E)\frac{\gamma_1\gamma_2}{\gamma_1+\gamma_2}\left[f_1(E)-f_2(E)\right]$</p><p>$\begin{aligned}f_1(E)-f_2(E)&=1\quad\mathrm{~if~}\quad\mu_1>E>\mu_2\&=0\quad\mathrm{otherwise}\end{aligned}$</p><p>$I=\frac q\hbar\frac{\gamma_1\gamma_2}{\gamma_1+\gamma_2}\intop_{\mu_2}^{\mu_1}\mathrm{d}ED_{\varepsilon}(E)$</p><p>$I=\frac q\hbar\frac{\gamma_1\gamma_2}{\gamma_1+\gamma_2}(\mu_1-\mu_2)\frac{(\gamma_1+\gamma_2)/2\pi}{(\mu-\varepsilon)^2+(\gamma_1+\gamma_2)^2}$</p><p>$G\equiv\frac I{V_{\mathrm{D}}}=\frac{q^2}h\frac{4\gamma_1\gamma_2}{\left(\gamma_1+\gamma_2\right)^2}=\frac{q^2}h\quad\mathrm{if}\quad\gamma_1=\gamma_2$</p><p>最终可以得到 $G$ ，这一步与source或者drain无关。</p><h2 id=potential-profile><a href=#potential-profile>#</a>
Potential profile</h2><p>[image] (<a class=link href="zotero://open-pdf/library/items/LSXK6XVI?page=31&amp;annotation=N5UT9XSL">pdf</a>)<br>(<a class=link href=zotero://select/library/items/6W5WRBAX>Datta, 2005, p. 16</a>)</p><p>如果不加gate，那么channel中的能级会随着源漏电压变化，理想情况下会一直处于源漏化学势的中间。但是加上gate，能级就会受gate电压调控，而不受源漏电压影响，这就导致源漏加正电和负电是不一样的，所以需要明确知道沟道电势来描述电流大小。</p><p>下面我们来计算channel中的电势。</p><blockquote><p>三个电容在不同支路上呈Y字型分布，由于三个电容均从同一个节点中获得电荷，由于电荷守恒，所以三个电容上的电荷 $Q = CV$ 相加应该等于 $0$ ，就可以得到中心节点的电压取值。</p></blockquote><p>根据电容模型可以得到：</p><p>$\begin{aligned}U_\mathrm{L}&=\frac{C_\mathrm{G}}{C_\mathrm{E}}\left(-qV_\mathrm{G}\right)+\frac{C_\mathrm{D}}{C_\mathrm{E}}\left(-qV_\mathrm{D}\right)\end{aligned}$</p><p>要记住角标L代表这个值是从拉普拉斯方程中获得，假设沟道中电荷为0.</p><p>否则需要使用泊松方程：</p><p>$\vec{\nabla}\cdot(\varepsilon_\mathrm{r}\vec{\nabla}V)=-\Delta\rho/\varepsilon_0$</p><p>$\begin{aligned}-q\Delta N=C_\mathrm{S}V+C_\mathrm{G}(V-V_\mathrm{G})+C_\mathrm{D}(V-V_\mathrm{D})\end{aligned}$</p><p>$U=U_\mathrm{L}+\frac{q^2}{C_\mathrm{E}}\Delta N$</p><p>常数 $q^2/C_\mathrm{E}\equiv U_0$ 代表没增加一个电子，势能的改变量。电子数量的该变量 $\Delta N$ 是相对于原来就在channel里能级 $\varepsilon$ 附近的电子数量 $N_0$ 来说的。</p><p><em>为什么沟道内本来就有电荷，而不需要考虑进去呢，因为我们只关注改变量？</em></p><h3 id=iterative-procedure-for-self-consistent-solution><a href=#iterative-procedure-for-self-consistent-solution>#</a>
Iterative procedure for self-consistent solution</h3><p>电势能的影响DOS的分布，</p><p>$\begin{aligned}N=\int_{-\infty}^{+\infty}\mathrm{d}ED_{\varepsilon}(E-U)\frac{\gamma_1f_1(E)+\gamma_2f_2(E)}{\gamma_1+\gamma_2}\end{aligned}$</p><p>$\begin{aligned}I&=\frac q\hbar\int_{-\infty}^{+\infty}\mathrm{d}ED_{\varepsilon}(E-U)\frac{\gamma_1\gamma_2}{\gamma_1+\gamma_2}\left[f_1(E)-f_2(E)\right]\end{aligned}$</p><blockquote><p>$E-U$ 意味着能级 $\varepsilon$ 被抬高，$V_G$ 和 $V_D$ 越小能级越高，电子越多能级越高，是与现实是吻合的</p></blockquote><p>由于 $U$ 中包含 $N$ ，$N$ 中包含 $U$ ，所以需要用迭代方法求解两者的自洽解：</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>1. guess a start U0
</span></span><span class=line><span class=cl>2. calculate N
</span></span><span class=line><span class=cl>3. use N to calculate Ucalc
</span></span><span class=line><span class=cl>4. update U: Unew = Uold + alpha * (Ucalc - Uold)
</span></span><span class=line><span class=cl>5. repeat 2 until Unew - Uold &lt; some converge value
</span></span></code></pre></td></tr></table></div></div><blockquote><p>但这个模型只能在小器件使用，因为假设了电势在沟道内处处相等</p></blockquote><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span><span class=lnt>27
</span><span class=lnt>28
</span><span class=lnt>29
</span><span class=lnt>30
</span><span class=lnt>31
</span><span class=lnt>32
</span><span class=lnt>33
</span><span class=lnt>34
</span><span class=lnt>35
</span><span class=lnt>36
</span><span class=lnt>37
</span><span class=lnt>38
</span><span class=lnt>39
</span><span class=lnt>40
</span><span class=lnt>41
</span><span class=lnt>42
</span><span class=lnt>43
</span><span class=lnt>44
</span><span class=lnt>45
</span><span class=lnt>46
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-matlab data-lang=matlab><span class=line><span class=cl><span class=n>clear</span>
</span></span><span class=line><span class=cl><span class=c>%Constants (all MKS, except energy which is in eV)</span>
</span></span><span class=line><span class=cl><span class=n>hbar</span><span class=p>=</span><span class=mf>1.055e-34</span><span class=p>;</span>
</span></span><span class=line><span class=cl><span class=n>q</span><span class=p>=</span><span class=mf>1.602e-19</span><span class=p>;</span>
</span></span><span class=line><span class=cl><span class=n>I0</span><span class=p>=</span><span class=n>q</span><span class=o>*</span><span class=n>q</span><span class=o>/</span><span class=n>hbar</span><span class=p>;</span>
</span></span><span class=line><span class=cl><span class=c>%Parameters</span>
</span></span><span class=line><span class=cl><span class=n>U0</span><span class=p>=</span><span class=mf>0.025</span><span class=p>;</span>
</span></span><span class=line><span class=cl><span class=n>kT</span><span class=p>=</span><span class=mf>0.025</span><span class=p>;</span>
</span></span><span class=line><span class=cl><span class=n>mu</span><span class=p>=</span><span class=mi>0</span><span class=p>;</span>
</span></span><span class=line><span class=cl><span class=n>epsilon</span><span class=p>=</span><span class=mf>0.2</span><span class=p>;</span>
</span></span><span class=line><span class=cl><span class=n>gamma1</span><span class=p>=</span><span class=mf>0.005</span><span class=p>;</span>
</span></span><span class=line><span class=cl><span class=n>gamma2</span><span class=p>=</span><span class=mf>0.005</span><span class=p>;</span>
</span></span><span class=line><span class=cl><span class=nb>gamma</span><span class=p>=</span><span class=n>gamma1</span><span class=o>+</span><span class=n>gamma2</span><span class=p>;</span>
</span></span><span class=line><span class=cl><span class=n>alphag</span><span class=p>=</span><span class=mi>1</span><span class=p>;</span>
</span></span><span class=line><span class=cl><span class=n>alphad</span><span class=p>=</span><span class=mf>0.5</span><span class=p>;</span>
</span></span><span class=line><span class=cl><span class=c>%Energy grid</span>
</span></span><span class=line><span class=cl><span class=n>E_grid_num</span><span class=p>=</span><span class=mi>501</span><span class=p>;</span>
</span></span><span class=line><span class=cl><span class=n>E</span><span class=p>=</span><span class=nb>linspace</span><span class=p>(</span><span class=o>-</span><span class=mi>1</span><span class=p>,</span><span class=mi>1</span><span class=p>,</span><span class=n>E_grid_num</span><span class=p>);</span>
</span></span><span class=line><span class=cl><span class=n>dE</span><span class=p>=</span><span class=n>E</span><span class=p>(</span><span class=mi>2</span><span class=p>)</span><span class=o>-</span><span class=n>E</span><span class=p>(</span><span class=mi>1</span><span class=p>);</span>
</span></span><span class=line><span class=cl><span class=n>D</span><span class=p>=(</span><span class=n>g</span><span class=o>/</span><span class=p>(</span><span class=mi>2</span><span class=o>*</span><span class=nb>pi</span><span class=p>))</span><span class=o>./</span><span class=p>((</span><span class=n>E</span><span class=o>.^</span><span class=mi>2</span><span class=p>)</span><span class=o>+</span><span class=p>((</span><span class=n>g</span><span class=o>/</span><span class=mi>2</span><span class=p>)</span>^<span class=mi>2</span><span class=p>));</span><span class=c>% Lorentzian Density of states per eV</span>
</span></span><span class=line><span class=cl><span class=n>D</span><span class=p>=</span><span class=n>D</span><span class=o>./</span><span class=p>(</span><span class=n>dE</span><span class=o>*</span><span class=n>sum</span><span class=p>(</span><span class=n>D</span><span class=p>));</span><span class=c>%Normalizing to one</span>
</span></span><span class=line><span class=cl><span class=c>%Bias</span>
</span></span><span class=line><span class=cl><span class=n>V_grid_num</span><span class=p>=</span><span class=mi>101</span><span class=p>;</span>
</span></span><span class=line><span class=cl><span class=n>V</span><span class=p>=</span><span class=nb>linspace</span><span class=p>(</span><span class=mi>0</span><span class=p>,</span><span class=mi>1</span><span class=p>,</span><span class=n>V_grid_num</span><span class=p>);</span>
</span></span><span class=line><span class=cl><span class=k>for</span> <span class=n>iV</span><span class=p>=</span><span class=mi>1</span><span class=p>:</span><span class=n>V_grid_num</span> 
</span></span><span class=line><span class=cl>    <span class=n>Vg</span><span class=p>=</span><span class=mi>0</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=n>Vd</span><span class=p>=</span><span class=n>V</span><span class=p>(</span><span class=n>iV</span><span class=p>);</span> 
</span></span><span class=line><span class=cl>    <span class=c>%Vd=0;Vg=V(iV); </span>
</span></span><span class=line><span class=cl>    <span class=n>mu1</span><span class=p>=</span><span class=n>mu</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=n>mu2</span><span class=p>=</span><span class=n>mu1</span><span class=o>-</span><span class=n>Vd</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=n>UL</span><span class=p>=</span><span class=o>-</span><span class=p>(</span><span class=n>alphag</span><span class=o>*</span><span class=n>Vg</span><span class=p>)</span><span class=o>-</span><span class=p>(</span><span class=n>alphad</span><span class=o>*</span><span class=n>Vd</span><span class=p>);</span>
</span></span><span class=line><span class=cl>    <span class=n>U</span><span class=p>=</span><span class=mi>0</span><span class=p>;</span><span class=c>%Self-consistent ﬁeld </span>
</span></span><span class=line><span class=cl>    <span class=n>dU</span><span class=p>=</span><span class=mi>1</span><span class=p>;</span> 
</span></span><span class=line><span class=cl>    <span class=k>while</span> <span class=n>dU</span><span class=o>&gt;</span><span class=mf>1e-6</span> 
</span></span><span class=line><span class=cl>        <span class=n>f1</span><span class=p>=</span><span class=mf>1.</span><span class=o>/</span><span class=p>(</span><span class=mi>1</span><span class=o>+</span><span class=nb>exp</span><span class=p>((</span><span class=n>E</span><span class=o>+</span><span class=n>epsilon</span><span class=o>+</span><span class=n>UL</span><span class=o>+</span><span class=n>U</span><span class=o>-</span><span class=n>mu1</span><span class=p>)</span><span class=o>./</span><span class=n>kT</span><span class=p>));</span> 
</span></span><span class=line><span class=cl>        <span class=n>f2</span><span class=p>=</span><span class=mf>1.</span><span class=o>/</span><span class=p>(</span><span class=mi>1</span><span class=o>+</span><span class=nb>exp</span><span class=p>((</span><span class=n>E</span><span class=o>+</span><span class=n>epsilon</span><span class=o>+</span><span class=n>UL</span><span class=o>+</span><span class=n>U</span><span class=o>-</span><span class=n>mu2</span><span class=p>)</span><span class=o>./</span><span class=n>kT</span><span class=p>));</span> 
</span></span><span class=line><span class=cl>        <span class=n>N</span><span class=p>(</span><span class=n>iV</span><span class=p>)=</span><span class=n>dE</span><span class=o>*</span><span class=n>sum</span><span class=p>(</span><span class=n>D</span><span class=o>.*</span><span class=p>((</span><span class=n>f1</span><span class=o>.*</span><span class=n>gamma1</span><span class=o>/</span><span class=nb>gamma</span><span class=p>)</span><span class=o>+</span><span class=p>(</span><span class=n>f2</span><span class=o>.*</span><span class=n>gamma2</span><span class=o>/</span><span class=nb>gamma</span><span class=p>)));</span> 
</span></span><span class=line><span class=cl>        <span class=n>Unew</span><span class=p>=</span><span class=n>U0</span><span class=o>*</span><span class=n>N</span><span class=p>(</span><span class=n>iV</span><span class=p>);</span>
</span></span><span class=line><span class=cl>        <span class=n>dU</span><span class=p>=</span><span class=nb>abs</span><span class=p>(</span><span class=n>U</span><span class=o>-</span><span class=n>Unew</span><span class=p>);</span> 
</span></span><span class=line><span class=cl>        <span class=n>U</span><span class=p>=</span><span class=n>U</span><span class=o>+</span><span class=mf>0.1</span><span class=o>*</span><span class=p>(</span><span class=n>Unew</span><span class=o>-</span><span class=n>U</span><span class=p>);</span> 
</span></span><span class=line><span class=cl>    <span class=k>end</span> 
</span></span><span class=line><span class=cl>    <span class=n>I</span><span class=p>(</span><span class=n>iV</span><span class=p>)=</span><span class=n>dE</span><span class=o>*</span><span class=n>I0</span><span class=o>*</span><span class=p>(</span><span class=n>sum</span><span class=p>(</span><span class=n>D</span><span class=o>.*</span><span class=p>(</span><span class=n>f1</span><span class=o>-</span><span class=n>f2</span><span class=p>)))</span><span class=o>*</span><span class=p>(</span><span class=n>g1</span><span class=o>*</span><span class=n>g2</span><span class=o>/</span><span class=n>g</span><span class=p>);</span> 
</span></span><span class=line><span class=cl><span class=k>end</span>
</span></span><span class=line><span class=cl><span class=n>hold</span> <span class=n>on</span> 
</span></span><span class=line><span class=cl><span class=n>h</span><span class=p>=</span><span class=n>plot</span><span class=p>(</span><span class=n>V</span><span class=p>,</span><span class=n>N</span><span class=p>,</span><span class=s>&#39;b&#39;</span><span class=p>);</span> 
</span></span><span class=line><span class=cl><span class=c>%h=plot(V,I,&#39;b&#39;); </span>
</span></span></code></pre></td></tr></table></div></div><blockquote><p>需要说明的是，程序与之前所写的公式有些许不同，因为DOS需要进行归一化，所以每一次都进行迭代不合理，又因为对能量的积分范围很大，所以将它与U有关的偏置放在费米函数里是合理的。相当于将DOS的上移变成了费米分布的下移，它们的overlap也就是乘积的积分是一样的。</p></blockquote></section><footer class=article-footer></footer><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/katex@0.16.9/dist/katex.min.css integrity=sha384-n8MVd4RsNIU0tAv4ct0nTaAbDJwPJzDEaqSD1odI+WdtXRGWt2kTvGFasHpSy3SV crossorigin=anonymous><script src=https://cdn.jsdelivr.net/npm/katex@0.16.9/dist/katex.min.js integrity=sha384-XjKyOOlGwcjNTAIQHIpgOno0Hl1YQqzUOEleOLALmuqehneUG+vnGctmUb0ZY0l8 crossorigin=anonymous defer></script><script src=https://cdn.jsdelivr.net/npm/katex@0.16.9/dist/contrib/auto-render.min.js integrity=sha384-+VBxd3r6XgURycqtZ117nYw44OOcIax56Z4dCRWbxyPt0Koah1uHoK0o4+/RRE05 crossorigin=anonymous defer></script><script>window.addEventListener("DOMContentLoaded",()=>{renderMathInElement(document.body,{delimiters:[{left:"$$",right:"$$",display:!0},{left:"$",right:"$",display:!1},{left:"\\(",right:"\\)",display:!1},{left:"\\[",right:"\\]",display:!0}],ignoredClasses:["gist"]})})</script></article><script src=//unpkg.com/@waline/client@v2/dist/waline.js></script><link href=//unpkg.com/@waline/client@v2/dist/waline.css rel=stylesheet><div id=waline class=waline-container></div><style>.waline-container{background-color:var(--card-background);border-radius:var(--card-border-radius);box-shadow:var(--shadow-l1);padding:var(--card-padding);--waline-font-size:var(--article-font-size)}.waline-container .wl-count{color:var(--card-text-color-main)}</style><script>Waline.init({avatar:"",dark:'html[data-scheme="dark"]',el:"#waline",emoji:["https://cdn.jsdelivr.net/gh/walinejs/emojis/weibo"],lang:"zh-CN",locale:{admin:"Admin",placeholder:null},placeholder:"怎么没人说话⊂(˃̶͈̀ε ˂̶͈́ ⊂ )人都在哪里(๑•̌.•๑)在哪里ʕ⸝⸝⸝˙Ⱉ˙ʔ",requiredMeta:["name","email","url"],serverURL:"https://waline-test-wheat-iota.vercel.app",visitor:"false"})</script><footer class=site-footer><section class=copyright>&copy;
2024 Will's blog</section><section class=powerby>Will's blog<br>使用 <a href=https://gohugo.io/ target=_blank rel=noopener>Hugo</a> 构建<br>主题 <b><a href=https://github.com/CaiJimmy/hugo-theme-stack target=_blank rel=noopener data-version=3.25.0>Stack</a></b> 由 <a href=https://jimmycai.com target=_blank rel=noopener>Jimmy</a> 设计</section></footer><div class=pswp tabindex=-1 role=dialog aria-hidden=true><div class=pswp__bg></div><div class=pswp__scroll-wrap><div class=pswp__container><div class=pswp__item></div><div class=pswp__item></div><div class=pswp__item></div></div><div class="pswp__ui pswp__ui--hidden"><div class=pswp__top-bar><div class=pswp__counter></div><button class="pswp__button pswp__button--close" title="Close (Esc)"></button>
<button class="pswp__button pswp__button--share" title=Share></button>
<button class="pswp__button pswp__button--fs" title="Toggle fullscreen"></button>
<button class="pswp__button pswp__button--zoom" title="Zoom in/out"></button><div class=pswp__preloader><div class=pswp__preloader__icn><div class=pswp__preloader__cut><div class=pswp__preloader__donut></div></div></div></div></div><div class="pswp__share-modal pswp__share-modal--hidden pswp__single-tap"><div class=pswp__share-tooltip></div></div><button class="pswp__button pswp__button--arrow--left" title="Previous (arrow left)">
</button>
<button class="pswp__button pswp__button--arrow--right" title="Next (arrow right)"></button><div class=pswp__caption><div class=pswp__caption__center></div></div></div></div></div><script src=https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe.min.js integrity="sha256-ePwmChbbvXbsO02lbM3HoHbSHTHFAeChekF1xKJdleo=" crossorigin=anonymous defer></script><script src=https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe-ui-default.min.js integrity="sha256-UKkzOn/w1mBxRmLLGrSeyB4e1xbrp4xylgAWb3M42pU=" crossorigin=anonymous defer></script><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/default-skin/default-skin.min.css crossorigin=anonymous><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe.min.css crossorigin=anonymous></main></div><script src=https://cdn.jsdelivr.net/npm/node-vibrant@3.1.6/dist/vibrant.min.js integrity="sha256-awcR2jno4kI5X0zL8ex0vi2z+KMkF24hUW8WePSA9HM=" crossorigin=anonymous></script><script type=text/javascript src=/ts/main.js defer></script><script>(function(){const e=document.createElement("link");e.href="https://fonts.googleapis.com/css2?family=Lato:wght@300;400;700&display=swap",e.type="text/css",e.rel="stylesheet",document.head.appendChild(e)})()</script></body></html>